{
    "title": "동기화된 공동 확산 기법을 통한 일관된 몽타주",
    "date": "2024-04-04T00:00:00Z",
    "link": "https://cs.kaist.ac.kr/board/view?bbs_id=research&bbs_sn=11054&page=1&skey=subject&svalue=&menu=265",
    "content": "사전 훈련된 이미지 확산 모델의 놀라운 능력은 고정 크기의 이미지를 생성하는 데뿐만 아니라 파노라마를 만드는 데에도 활용되어 왔습니다. 그러나 여러 이미지의 단순한 스티칭은 종종 보이는 줄무늬를 유발합니다. 이 한계를 극복하기 위해 우리는 SyncDiffusion을 제안합니다. 이는 지각적 유사성 손실로부터 경사 하강을 통해 여러 확산을 동기화하는 플러그 앤 플레이 모듈입니다. 구체적으로 각 소음 제거 단계에서 예측된 소음 제거 이미지를 사용하여 지각적 손실의 기울기를 계산함으로써 일관된 몽타주를 달성하는 데 유의미한 지도를 제공합니다. 실험 결과는 우리의 방법이 이전 방법과 비교하여 훨씬 더 일관된 결과물을 생성하면서 여전히 입력 프롬프트와 충실성 및 호환성을 유지한다는 것을 보여줍니다.\n1. 연구배경\n전형적인 이미지 확산 모델은 고정된 크기의 이미지를 생성하도록 훈련되어 있어, 다양한 임의 크기의 이미지를 생성하려면 여러 이미지를 이어 붙이는 작업이 필요합니다. 이 문제에 대응하기 위해 두 가지 접근 방법이 제안되었습니다. 첫 번째는 이미지 외삽법으로, 순차적인 인페인팅을 통해 파노라마 이미지를 생성합니다. 그러나 이 접근 방법은 종종 명확한 경계선과 유사한 패턴을 반복하여 현실적이지 않은 파노라마를 생성합니다. 또 다른 방법은 공동 확산으로, 여러 개의 창이 동시에 역확산 과정을 수행하면서 각 단계에서 겹친 영역에서 잡음이 섞인 잠재변수를 평균화합니다. 이를 통해 부드럽게 이어진 몽타주를 생성할 수 있지만 이미지의 내용과 스타일이 창 간에 다를 수 있습니다. 이러한 불일치는 겹친 영역의 잠재변수가 단순히 평균화되기 때문에 발생하며 이 때문에 그들 간의 일관성을 고려하지 않게 됩니다.\n이전 연구에서 발생한 비현실적이거나 일관성 없는 이미지 생성의 한계를 해결하기 위해 우리는 공동 확산에 적용되는 SyncDiffusion이라는 새로운 동기화 모듈을 제안합니다. 이 모듈은 파노라마 이미지 내의 다양한 부분들 간의 전역 일관성을 달성하기 위한 역확산 프로세스를 안내합니다. 이전 확산 방법과 유사하게 SyncDiffusion은 각 단계에서 중간의 잡음이 섞인 잠재변수를 조정하면서 역확산 프로세스를 조정합니다. 이러한 조정 과정은 특히 여러 창 간에 계산된 지각적 유사도 손실에서의 경사 하강으로부터 제공됩니다. 잡음이 섞인 이미지로 계산된 손실은 역확산 프로세스를 효과적으로 조정할 수 없기 때문에, 우리는 현재 잡음이 섞인 이미지로부터 최종 출력을 예측하는 DDIM의 비 마르코비안 공식에서 영감을 얻습니다. 각 단계에서 예측된 최종 이미지를 사용하여 지각적 유사도 손실을 계산하고, 기울기를 잡음이 섞인 이미지를 통해 역전파합니다. 각 역확산 단계에서 잠재변수을 평균화하는 이전의 매끄러운 이음 기술과의 시너지를 활용하여, 우리의 공동 확산 프레임워크는 지역적 일관성과 전역 일관성을 모두 지니는 이미지를 생성할 수 있습니다. 이는 기존 확산 모델을 재학습하거나 세밀하게 조정할 필요 없이 제로샷 방식으로 달성됩니다. 우리는 SyncDiffusion의 범용성을 보이기 위해 세 가지 응용 프로그램에 이 방법을 적용합니다.\n2. 연구내용\n이미지 확산 모델에서 각 샘플은 사전학습된 인코더와 디코더를 통해 실제 이미지로 부호화될 수 있는 2D 그리드의 잠재변수입니다. 고정된 크기의 이미지에 대해 학습된 확산 모델은 다양한 크기의 이미지를 생성하는 데 직접 사용될 수 없습니다. MultiDiffusion (Bar-Tal et al.)은 이 한계를 다루기 위해 다중 창 공동 확산 접근법을 도입합니다. 이 프레임워크는 각 역확산 단계에서 창 간의 색상이나 특징을 평균화하여 여러 창을 통해 생성된 이미지를 매끄럽게 통합합니다. 각 창에 대한 역확산 프로세스를 동시에 실행하는 공동 확산 프로세스 중에 창에서의 잡음이 섞인 이미지 는 먼저 파노라마 공간에서 평균화되어 결합된 잡음이 섞인 이미지 를 얻습니다. 그런 다음 는 각 창에 대해 다시 잘리게 됩니다.\nMultiDiffusion은 공동 확산에서 부드러운 파노라마를 생성할 수 있지만, 일관성 있고 현실적인 이미지를 생성하는 데 종종 실패합니다. 이러한 비일관성은 주로 두 가지 이유에서 발생합니다. 첫째, 평균 연산은 겹쳐진 영역에서 잠재변수를 정렬하지만, 이미지의 내용이나 스타일을 일치시키지는 않습니다. 둘째, 이는 인접한 창들만이 서로에게 영향을 미치도록 하며, 먼 창들 간의 일관성을 달성할 수는 없습니다. 이 문제를 해결하기 위해 우리는 SyncDiffusion이라는 모듈을 소개합니다. SyncDiffusion은 기존의 공동 확산 프레임워크에 쉽게 통합될 수 있으며 일관된 몽타주를 생성할 수 있게 합니다. MultiDiffusion과 마찬가지로 우리의 모듈은 역확산 프로세스의 각 단계에서 잡음이 섞인 잠재변수를 업데이트합니다. 그러나 겹쳐진 영역에서 잠재변수을 평균화하는 대신 SyncDiffusion은 창 간에 계산된 지각적 유사도 손실(L로 표시)로부터의 기울기 역전파를 사용하여 업데이트를 수행합니다. 우리는 지각적 유사도 손실 계산에 LPIPS를 사용합니다. 효율적인 계산을 위해 인덱스가 0인 기준 창을 설정합니다. 그리고 Sec. 6.3에서 논의된대로 각 잡음 데이터의 예측된 최종 관찰을 활용합니다. 우리는 현재의 잡음 이미지가 아니라 예측된 잡음이 제거된 이미지를 활용하여 창 간의 일관성을 측정하고, 이를 통한 기울기 역전파를 수행합니다.\n3. 기대효과\n아래 그림은 파노라마 이미지 생성에 대한 우리의 방법의 결과를 보여줍니다. Blended Latent Diffusion (BLD)은 순차적인 인페인팅 방식으로 인해 종종 가시적인 경계선이 나타나고 외삽에서 반복적인 패턴을 생성합니다. MultiDiffusion (MD)은 매끄러운 이미지를 생성하는데 성공하지만, 일관성 없는 이미지를 생성하는 경향이 있습니다. 아래 그림에서 보이다시피 SyncDiffusion은 시각적으로 및 의미론적으로 더 일관된 파노라마 이미지를 생성합니다.\n4. 연구실적\n〇 NeurIPS 2023 - 포스터 발표.\n〇 NeurIPS 2023 Workshop on Diffusion Models - 포스터 발표.\n〇 NeurIPS 2023 Workshop on Machine Learning for Creativity and Design - Splotlight 발표.",
    "tag": "csweb.ai",
    "id": 13
}